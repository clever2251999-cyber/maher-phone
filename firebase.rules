rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // ğŸ”¥ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
    match /products/{productId} {
      allow read: if true; // Ø£ÙŠ Ø­Ø¯ ÙŠÙ‚Ø±Ø£ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
      allow write: if request.auth != null 
                    && request.auth.token.email == "clever2251999@gmail.com"; // Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø· ÙŠÙƒØªØ¨
    }

    // ğŸ”¥ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    match /users/{userId} {
      // ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙ‚Ø±Ø£/ÙŠÙƒØªØ¨ Ø¨ÙŠØ§Ù†Ø§Øª Ù†ÙØ³Ù‡ ÙÙ‚Ø·
      allow read, write: if request.auth != null && request.auth.uid == userId;

      // ğŸ”¥ Ø§Ù„Ø³Ù„Ø© Ø§Ù„Ø®Ø§ØµØ© Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù…
      match /cart/{cartId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }
    }

    // ğŸ”¥ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
    match /orders/{orderId} {
      // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙ†Ø´Ø¦ Ø·Ù„Ø¨ Ù„Ù†ÙØ³Ù‡ ÙÙ‚Ø·
      allow create: if request.auth != null 
                     && request.resource.data.userId == request.auth.uid;

      // Ø§Ù„Ø£Ø¯Ù…Ù† ÙŠÙ‚Ø±Ø£ ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
      // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙ‚Ø±Ø£ Ø·Ù„Ø¨Ø§ØªÙ‡ ÙÙ‚Ø·
      allow read: if request.auth != null 
                   && (request.auth.token.email == "clever2251999@gmail.com" 
                       || resource.data.userId == request.auth.uid);

      // ØªØ­Ø¯ÙŠØ« ÙˆØ­Ø°Ù Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ù…Ù†ÙˆØ¹
      allow update, delete: if false;
    }
  }
}
