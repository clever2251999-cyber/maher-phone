<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø¥Ø¶Ø§ÙØ© ØªÙ„ÙŠÙÙˆÙ† Ù…Ø³ØªØ¹Ù…Ù„</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
    body{
        font-family:"Cairo", sans-serif;
        direction:rtl;
        background:#f3f4f6;
        margin:0;
        padding:0;
    }

    .container{
        max-width:500px;
        margin:30px auto;
        background:white;
        padding:25px;
        border-radius:20px;
        box-shadow:0 4px 20px #00000020;
    }

    h2{
        text-align:center;
        margin-bottom:20px;
    }

    input, textarea{
        width:100%;
        padding:12px;
        margin:10px 0;
        border:1px solid #ccc;
        border-radius:12px;
        font-size:16px;
    }

    button{
        width:100%;
        padding:14px;
        background:#111;
        color:white;
        border:none;
        border-radius:14px;
        font-size:18px;
        cursor:pointer;
        margin-top:10px;
    }

    #backBtn{
        background:#d9534f;
        margin-top:12px;
    }
</style>
</head>
<body>

<div class="container">
    <h2>â• Ø¥Ø¶Ø§ÙØ© ØªÙ„ÙŠÙÙˆÙ† Ù…Ø³ØªØ¹Ù…Ù„</h2>

    <input type="text" id="name" placeholder="Ø§Ø³Ù… Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†" required>
    <input type="number" id="price" placeholder="Ø§Ù„Ø³Ø¹Ø±" required>
    <textarea id="specs" placeholder="Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª" rows="4"></textarea>

    <label>ğŸ“· ØµÙˆØ±Ø© Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†</label>
    <input type="file" id="image" accept="image/*">

    <button onclick="addUsedProduct()">âœ” Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</button>
    <button id="backBtn" onclick="history.back()">Ø±Ø¬ÙˆØ¹</button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<script src="firebase.js"></script>

<script>

function addUsedProduct(){
    let name = document.getElementById("name").value;
    let price = document.getElementById("price").value;
    let specs = document.getElementById("specs").value;
    let imageFile = document.getElementById("image").files[0];

    if(!name || !price){
        alert("âš  ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø³Ø¹Ø±");
        return;
    }

    if(!imageFile){
        alert("âš  ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©");
        return;
    }

    // Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©
    let ref = storage.ref("usedProducts/" + Date.now() + "_" + imageFile.name);
    ref.put(imageFile).then(()=> ref.getDownloadURL()).then(imageURL => {

        // Ø­ÙØ¸ ÙÙŠ Firestore
        db.collection("usedProducts").add({
            name,
            price,
            specs,
            imageURL,
            createdAt: Date.now()
        }).then(()=>{
            alert("âœ” ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ„ÙŠÙÙˆÙ† Ø§Ù„Ù…Ø³ØªØ¹Ù…Ù„");
            location.href = "used-products.html";
        });

    });
}

</script>

</body>
</html>
