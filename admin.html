<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Maher Phone</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    body{
        font-family:"Cairo", sans-serif;
        margin:0;
        background:#f3f4f6;
        direction:rtl;
    }

    header{
        background:#0d6efd;
        padding:20px;
        color:white;
        text-align:center;
        font-size:26px;
        font-weight:700;
        box-shadow:0 2px 10px #00000030;
    }

    #admin-panel{
        text-align:center;
        margin:25px auto;
    }

    #admin-panel button{
        padding:14px 22px;
        border:none;
        background:#111;
        color:white;
        border-radius:12px;
        font-size:18px;
        cursor:pointer;
        margin:8px;
        font-weight:600;
    }

    #products{
        display:grid;
        grid-template-columns:repeat(auto-fill, minmax(260px, 1fr));
        gap:20px;
        padding:20px;
        max-width:1300px;
        margin:auto;
    }

    .card{
        background:white;
        padding:15px;
        border-radius:16px;
        box-shadow:0 4px 15px #00000015;
        text-align:center;
    }

    .card img{
        width:100%;
        height:220px;
        object-fit:cover;
        border-radius:12px;
    }

    .btn{
        padding:10px 16px;
        border:none;
        border-radius:10px;
        cursor:pointer;
        font-size:15px;
        font-weight:600;
        margin-top:8px;
        width:100%;
    }

    .edit-btn{ background:#ffc107; }
    .del-btn{ background:#d9534f; color:white; }
    .back-btn{
        background:#6c757d;
        color:white;
        width:200px;
        margin-top:20px;
    }
  </style>
</head>
<body>

<header>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Maher Phone</header>

<div id="admin-panel">
    <button onclick="location.href='add-product.html'">â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</button>
    <button class="back-btn" onclick="location.href='products.html'">ğŸ”™ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù…ØªØ¬Ø±</button>
</div>

<div id="products"></div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="firebase.js"></script>

<script>

// ğŸ” Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø¬Ø¯ÙŠØ¯
if (localStorage.getItem("adminLogged") !== "true") {
    alert("âŒ Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¯Ø®ÙˆÙ„!");
    location.href = "products.html";
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
function loadProducts(){
    const container = document.getElementById("products");
    container.innerHTML = "<p style='text-align:center;width:100%'>â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</p>";

    db.collection("products").orderBy("createdAt", "desc").get().then(snap=>{
        container.innerHTML = "";

        snap.forEach(doc=>{
            let p = doc.data();

            container.innerHTML += `
                <div class="card">
                    <img src="${p.imageURL}">
                    <h3>${p.name}</h3>
                    <p>${p.description}</p>
                    <p><strong>${p.price} Ø¬Ù†ÙŠÙ‡</strong></p>

                    <button class="btn edit-btn" onclick="editProduct('${doc.id}')">âœ ØªØ¹Ø¯ÙŠÙ„</button>
                    <button class="btn del-btn" onclick="deleteProduct('${doc.id}')">ğŸ—‘ Ø­Ø°Ù</button>
                </div>
            `;
        });
    });
}

loadProducts();

// Ø§Ù„Ø­Ø°Ù
function deleteProduct(id){
    if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ")) {
        db.collection("products").doc(id).delete().then(()=>{
            alert("âœ” ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬");
            loadProducts();
        });
    }
}

// Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
function editProduct(id){
    location.href = "edit-product.html?id=" + id;
}

</script>

</body>
</html>
