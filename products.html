<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8">
  <title>Maher Phone - Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body{
        font-family:Arial;
        direction:rtl;
        margin:0;
        background:#f2f2f2;
    }

    header{
        background:#2196f3;
        padding:15px;
        color:white;
        text-align:center;
        font-size:22px;
        font-weight:bold;
        position:sticky;
        top:0;
    }

    #products{
        display:grid;
        grid-template-columns:repeat(auto-fill, minmax(250px, 1fr));
        gap:15px;
        padding:15px;
    }

    .card{
        background:white;
        padding:15px;
        border-radius:10px;
        box-shadow:0 0 8px #00000022;
        text-align:center;
        transition:.3s;
    }

    .card:hover{
        transform:scale(1.03);
    }

    .card img{
        width:100%;
        height:220px;
        object-fit:cover;
        border-radius:10px;
    }

    .price{
        color:#4caf50;
        font-size:18px;
        font-weight:bold;
        margin:10px 0;
    }

    .btn{
        background:#2196f3;
        color:white;
        padding:10px;
        border:none;
        border-radius:6px;
        cursor:pointer;
        width:100%;
    }

    #cart-btn{
        position:fixed;
        bottom:20px;
        right:20px;
        padding:12px 18px;
        border:none;
        background:#4caf50;
        color:white;
        border-radius:50px;
        cursor:pointer;
        font-size:16px;
        box-shadow:0 0 8px #00000044;
    }

    #logout{
        position:fixed;
        bottom:20px;
        left:20px;
        padding:10px 15px;
        border:none;
        background:red;
        color:white;
        border-radius:6px;
        cursor:pointer;
        font-size:14px;
    }
  </style>
</head>

<body>

<header>ğŸ“± Maher Phone - Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</header>

<div id="products"></div>

<button id="cart-btn" onclick="goCart()">ğŸ›’ Ø§Ù„Ø³Ù„Ø©</button>
<button id="logout" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="firebase.js"></script>

<script>

auth.onAuthStateChanged(user=>{
    loadProducts();
});

function logout(){
    auth.signOut();
    location.href="index.html";
}

function goCart(){
    location.href = "cart.html";
}

function addToCart(item){
    let cart = JSON.parse(localStorage.getItem("cart") || "[]");
    cart.push(item);
    localStorage.setItem("cart", JSON.stringify(cart));
    alert("ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©");
}

function loadProducts(){
    const container = document.getElementById("products");
    container.innerHTML = "<p style='text-align:center;width:100%'>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</p>";

    db.collection("products")
        .orderBy("createdAt", "desc")
        .get()
        .then(snap=>{
            container.innerHTML = "";
            snap.forEach(doc=>{
                let p = doc.data();

                container.innerHTML += `
                    <div class="card">
                        <img src="${p.imageURL}" alt="">
                        <h3>${p.name}</h3>
                        <p>${p.description}</p>
                        <div class="price">${p.price} Ø¬Ù†ÙŠÙ‡</div>
                        <button class="btn" onclick='addToCart(${JSON.stringify({
                            id: doc.id,
                            name: p.name,
                            price: p.price,
                            imageURL: p.imageURL
                        })})'>ğŸ›’ Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
                    </div>
                `;
            });
        })
        .catch(err=>{
            container.innerHTML = "<p style='color:red;text-align:center'>Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.</p>";
        });
}

</script>

</body>
</html>
