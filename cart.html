<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="firebase.js"></script>

<script>
auth.onAuthStateChanged(async user => {
    if (!user) return location.href="index.html";

    let uid = user.uid;

    let cartSnap = await db.collection("users").doc(uid).collection("cart").get();

    let container = document.getElementById("cartItems");

    cartSnap.forEach(async item => {
        let prod = await db.collection("products").doc(item.data().productId).get();
        let p = prod.data();

        container.innerHTML += `
            <div class="card p-2 mb-2">
                <h4>${p.name}</h4>
                <p>${p.price} جنيه</p>
            </div>
        `;
    });
});

function checkout(){
    location.href = "checkout.html";
}
</script>
