<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8">
  <title>Maher Phone - Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    body{
        font-family:"Cairo", sans-serif;
        direction:rtl;
        margin:0;
        background:#0a0a0a;
        color:#e8e8e8;
    }

    header{
        background:#0f0f0f;
        padding:20px;
        text-align:center;
        font-size:28px;
        font-weight:700;
        position:sticky;
        top:0;
        z-index:10;
        color:#00aaff;
        box-shadow:0 0 12px #00aaff55;
        border-bottom:1px solid #00aaff33;
    }

    #categories{
        display:flex;
        overflow-x:auto;
        gap:12px;
        padding:15px;
        background:#0d0d0d;
        position:sticky;
        top:70px;
        z-index:9;
        box-shadow:0 0 10px #00aaff33 inset;
        border-bottom:1px solid #00aaff22;
    }

    #categories button{
        padding:10px 18px;
        background:#111;
        color:#d8d8d8;
        border:none;
        border-radius:50px;
        cursor:pointer;
        white-space:nowrap;
        font-size:15px;
        font-weight:600;
        transition:0.25s;
        border:1px solid #00aaff33;
    }

    #categories button:hover{
        background:#0d0d0d;
        color:#00aaff;
        box-shadow:0 0 10px #00aaff55;
    }

    #categories button.active{
        background:#00aaff33;
        color:#fff;
        box-shadow:0 0 12px #00aaff88;
        border:1px solid #00aaff55;
    }

    #adminPanel{
        padding:20px;
        text-align:center;
        display:none;
    }

    #adminPanel button{
        padding:12px 20px;
        font-size:17px;
        border:none;
        border-radius:14px;
        background:#00aaff;
        color:white;
        cursor:pointer;
        margin-bottom:10px;
        transition:0.25s;
    }

    #adminPanel button:hover{
        background:#0088cc;
        box-shadow:0 0 12px #00aaff88;
    }

    #products{
        display:grid;
        grid-template-columns:repeat(auto-fill, minmax(260px, 1fr));
        gap:25px;
        padding:30px;
        max-width:1300px;
        margin:auto;
    }

    .card{
        background:#111;
        padding:18px;
        border-radius:20px;
        box-shadow:0 0 15px #00aaff11;
        text-align:center;
        transition:0.3s;
        border:1px solid #00aaff22;
    }

    .card:hover{
        transform:translateY(-4px);
        box-shadow:0 0 18px #00aaff55;
        border-color:#00aaff66;
    }

    .card img{
        width:100%;
        height:240px;
        object-fit:cover;
        border-radius:16px;
        box-shadow:0 0 10px #00aaff33;
    }

    h3{
        margin:12px 0 6px;
        color:#fff;
    }

    p{
        color:#ccc;
        font-size:15px;
    }

    .price{
        margin-top:8px;
        font-size:20px;
        font-weight:700;
        color:#00aaff;
        text-shadow:0 0 8px #00aaff55;
    }

    .btn{
        background:#0d0d0d;
        color:#fff;
        padding:12px;
        border:none;
        border-radius:14px;
        cursor:pointer;
        width:100%;
        font-size:17px;
        font-weight:600;
        margin-top:12px;
        border:1px solid #00aaff44;
        transition:0.25s;
    }

    .btn:hover{
        background:#00aaff33;
        color:#fff;
        box-shadow:0 0 12px #00aaff88;
        border-color:#00aaff88;
    }

    .del-btn{
        background:#b82222;
        margin-top:10px;
        border:none;
        box-shadow:0 0 10px #ff222244;
    }

    .del-btn:hover{
        background:#ff0000;
        box-shadow:0 0 15px #ff000066;
    }

    #cart-btn{
        position:fixed;
        bottom:20px;
        right:20px;
        padding:16px 22px;
        background:#00aaff;
        color:white;
        border:none;
        border-radius:50px;
        font-size:17px;
        cursor:pointer;
        box-shadow:0 0 18px #00aaff55;
        transition:0.25s;
    }

    #cart-btn:hover{
        background:#0088cc;
        box-shadow:0 0 18px #00aaffaa;
    }

    #logout{
        position:fixed;
        bottom:20px;
        left:20px;
        padding:14px 20px;
        background:#b82222;
        color:white;
        border:none;
        border-radius:12px;
        font-size:16px;
        cursor:pointer;
        box-shadow:0 0 12px #ff000055;
    }

    #logout:hover{
        background:#ff0000;
        box-shadow:0 0 15px #ff000088;
    }


    /*=====================================*/
    /*        ğŸ“± ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„           */
    /*=====================================*/
    @media (max-width: 600px) {

        header{
            font-size:22px;
            padding:14px;
        }

        #categories{
            padding:10px;
            gap:8px;
            top:60px;
        }

        #categories button{
            padding:8px 14px;
            font-size:14px;
        }

        #products{
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            padding:15px;
            gap:18px;
        }

        .card{
            padding:14px;
            border-radius:16px;
        }

        .card img{
            height:180px;
        }

        h3{
            font-size:17px;
        }

        p{
            font-size:14px;
        }

        .price{
            font-size:18px;
        }

        .btn{
            font-size:15px;
            padding:10px;
        }

        #cart-btn{
            padding:12px 18px;
            font-size:15px;
            bottom:15px;
            right:15px;
        }

        #logout{
            padding:10px 16px;
            font-size:14px;
            bottom:15px;
            left:15px;
        }
    }

  </style>
</head>
<body>

<header>ğŸ“± Maher Phone</header>

<div style="
    background:#0f0f0f;
    padding:6px 0;
    text-align:center;
    font-size:18px;
    color:#00aaff;
    border-bottom:1px solid #00aaff22;
    box-shadow:0 0 10px #00aaff22 inset;
">
    <span style="font-size:20px;">ğŸ“</span>
    <strong>Ù„Ù„ØªÙˆØ§ØµÙ„:</strong>

    <span style="font-weight:900; font-size:20px; margin:0 8px; color:#e8e8e8;">
        01110112115
    </span>

    <span style="color:#00aaff;"> - </span>

    <span style="font-weight:900; font-size:20px; margin:0 8px; color:#e8e8e8;">
        01157642100
    </span>
</div>

<div style="text-align:center; padding:15px;">
    <button onclick="location.href='used-products.html'"
        style="
            background:#0d0d0d;
            border:1px solid #00aaff44;
            padding:10px 18px;
            font-size:17px;
            border-radius:50px;
            cursor:pointer;
            display:inline-flex;
            align-items:center;
            gap:8px;
            box-shadow:0 0 12px #00aaff33;
            color:#fff;">
        ğŸ“± ØªÙ„ÙŠÙÙˆÙ†Ø§Øª Ù…Ø³ØªØ¹Ù…Ù„Ø©
    </button>
</div>

<div id="categories">
    <button class="active" onclick="filterCategory('all')">ğŸ” Ø§Ù„ÙƒÙ„</button>
    <button onclick="filterCategory('chargers')">ğŸ”Œ Ø§Ù„Ø´ÙˆØ§Ø­Ù†</button>
    <button onclick="filterCategory('cables')">ğŸ”— Ø§Ù„ÙˆØµÙ„Ø§Øª</button>
    <button onclick="filterCategory('handsfree')">ğŸ§ Ø§Ù„Ù‡Ø§Ù†Ø¯ÙØ±ÙŠ</button>
    <button onclick="filterCategory('screens')">ğŸ“± Ø§Ù„Ø§Ø³ÙƒØ±ÙŠÙ†Ø§Øª</button>
    <button onclick="filterCategory('airpods')">ğŸµ Ø§Ù„Ø§ÙŠØ±Ø¨ÙˆØ¯Ø²</button>
    <button onclick="filterCategory('speakers')">ğŸ”Š Ø§Ù„Ø³Ù…Ø§Ø¹Ø§Øª</button>
</div>

<div id="adminPanel">
    <button onclick="location.href='add-product.html'">â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</button>
</div>

<div id="products"></div>

<button id="cart-btn" onclick="goCart()">ğŸ›’ Ø§Ù„Ø³Ù„Ø©</button>
<button id="logout" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="firebase.js"></script>

<script>

let allProducts = [];
let currentUser = null;
const ADMIN_EMAIL = "clever2251999@gmail.com";

auth.onAuthStateChanged(user => {
    currentUser = user;

    if (user && !user.isAnonymous && user.email === ADMIN_EMAIL){
        document.getElementById("adminPanel").style.display = "block";
    }

    loadProducts();
});

function logout(){
    auth.signOut();
    location.href="index.html";
}

function goCart(){
    location.href="cart.html";
}

function addToCart(item){
    let cart = JSON.parse(localStorage.getItem("cart") || "[]");
    cart.push(item);
    localStorage.setItem("cart", JSON.stringify(cart));
    alert("âœ” ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©");
}

function deleteProduct(id){
    if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ")){
        db.collection("products").doc(id).delete();
        alert("âœ” ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬");
        loadProducts();
    }
}

async function loadProducts(){

    const container = document.getElementById("products");
    container.innerHTML = "<p style='width:100%;text-align:center'>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</p>";

    allProducts = [];

    let snap = await db.collection("products").orderBy("createdAt", "desc").get();

    snap.forEach(doc => {
        allProducts.push({
            ...doc.data(),
            id: doc.id
        });
    });

    renderProducts(allProducts);
}

function renderProducts(list){

    const container = document.getElementById("products");
    container.innerHTML = "";

    if (list.length === 0){
        container.innerHTML = "<p style='text-align:center;width:100%;color:#ccc'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…</p>";
        return;
    }

    list.forEach(p => {

        let delBtn = "";
        if (currentUser && !currentUser.isAnonymous && currentUser.email === ADMIN_EMAIL){
            delBtn = `
                <button class="btn del-btn" onclick="deleteProduct('${p.id}')">
                    ğŸ—‘ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬
                </button>`;
        }

        container.innerHTML += `
            <div class="card">
                <img src="${p.imageURL || p.image}">
                <h3>${p.name}</h3>
                <p>${p.description}</p>
                <div class="price">${p.price} Ø¬Ù†ÙŠÙ‡</div>

                <button class="btn" onclick='addToCart(${JSON.stringify({
                    id: p.id,
                    name: p.name,
                    price: p.price,
                    image: p.imageURL || p.image
                })})'>
                    ğŸ›’ Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©
                </button>

                ${delBtn}
            </div>
        `;
    });
}

function filterCategory(cat){

    document.querySelectorAll("#categories button")
            .forEach(b => b.classList.remove("active"));
    event.target.classList.add("active");

    if (cat === "all"){
        renderProducts(allProducts);
    } else {
        renderProducts(allProducts.filter(p => p.category === cat));
    }
}

</script>

</body>
</html>
