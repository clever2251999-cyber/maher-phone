<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8">
<title>Ø§Ù„Ø³Ù„Ø©</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body{
        font-family:"Cairo", sans-serif;
        direction:rtl;
        background:#0a0a0f;
        margin:0;
        padding:20px;
        color:#e8e8e8;
    }

    h2{
        text-align:center;
        color:#00eaff;
        text-shadow:0 0 12px #00eaff;
        margin-bottom:20px;
        font-size:26px;
        font-weight:700;
    }

    h3{
        margin-top:25px;
        color:#00ffaa;
        text-shadow:0 0 10px #00ffaa;
    }

    .card{
        background:#111;
        padding:15px;
        margin-bottom:12px;
        border-radius:14px;
        border:1px solid #00aaff55;
        box-shadow:0 0 12px #00aaff22;
        transition:0.25s;
    }

    .card:hover{
        transform:translateY(-3px);
        box-shadow:0 0 18px #00aaff88;
        border-color:#00aaff;
    }

    button{
        width:100%;
        padding:12px;
        margin:12px 0;
        border:none;
        border-radius:12px;
        font-size:17px;
        cursor:pointer;
        font-weight:600;
        background:#00aaff;
        color:#000;
        box-shadow:0 0 12px #00aaff55;
        transition:0.25s;
    }

    button:hover{
        background:#0099dd;
        box-shadow:0 0 18px #00aaffaa;
    }

    .delete-btn{
        background:#ff0033 !important;
        color:white !important;
        box-shadow:0 0 12px #ff003355 !important;
    }

    .delete-btn:hover{
        background:#cc002a !important;
        box-shadow:0 0 18px #ff003399 !important;
    }

    input{
        width:100%;
        padding:12px;
        background:#0d0d0d;
        border:1px solid #00aaff33;
        border-radius:10px;
        margin:10px 0;
        color:#fff;
        font-size:16px;
        outline:none;
        transition:0.25s;
    }

    input:focus{
        border-color:#00aaff;
        box-shadow:0 0 10px #00aaff55;
    }

    @media(max-width:600px){
        body{padding:15px;}
        h2{font-size:22px;}
        .card{padding:12px;}
        input{font-size:15px;}
    }
</style>
</head>

<body>

<h2>ğŸ›’ Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2>

<div id="cart-items"></div>

<h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>

<input id="name" placeholder="Ø§Ù„Ø§Ø³Ù…">
<input id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
<input id="address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†">

<button onclick="sendOrder()">ğŸ“¨ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="firebase.js"></script>

<script>

function loadCart(){
    const cart = JSON.parse(localStorage.getItem("cart") || "[]");
    const box = document.getElementById("cart-items");

    if(cart.length === 0){
        box.innerHTML = "<p style='text-align:center;color:#ccc;'>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</p>";
        return;
    }

    let html = "";
    cart.forEach((item,i)=>{
        html += `
        <div class="card">
            <b style="color:#00eaff;">${item.name}</b><br>
            <span style="color:#00ffaa;">Ø§Ù„Ø³Ø¹Ø±: ${item.price} Ø¬Ù†ÙŠÙ‡</span><br>
            <button class="delete-btn" onclick="deleteItem(${i})">ğŸ—‘ Ø­Ø°Ù</button>
        </div>`;
    });
    box.innerHTML = html;
}

function deleteItem(i){
    let cart = JSON.parse(localStorage.getItem("cart") || "[]");
    cart.splice(i,1);
    localStorage.setItem("cart", JSON.stringify(cart));
    loadCart();
}

loadCart();


// â­â­â­ Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ + ÙØªØ­ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ â­â­â­
async function sendOrder(){
    const name = document.getElementById("name").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const address = document.getElementById("address").value.trim();
    const cart = JSON.parse(localStorage.getItem("cart") || "[]");

    if(!name || !phone || !address || cart.length === 0){
        alert("âš ï¸ Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø©");
        return;
    }

    // ØªØ¬Ù‡ÙŠØ² ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
    let itemsText = "";
    cart.forEach((item, i) => {
        itemsText += `â€¢ ${item.name} - ${item.price} Ø¬Ù†ÙŠÙ‡\n`;
    });

    // Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù„ÙˆØ§ØªØ³
    const message =
`ğŸ›’ *Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø±*
----------------------
*ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…:* ${name}
*ğŸ“ Ø§Ù„Ù‡Ø§ØªÙ:* ${phone}
*ğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:* ${address}

*ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:*
${itemsText}

âœ”ï¸ Ø´ÙƒØ±Ø§Ù‹ Ù„Ø·Ù„Ø¨Ùƒ Ù…Ù† Ù…ØªØ¬Ø± Ù…Ø§Ù‡Ø± ÙÙˆÙ†`;

    // Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
    const whatsappNumber = "201158078805"; // Ù„Ø§Ø²Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 20

    // Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
    const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;

    // ÙØªØ­ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
    window.location.href = whatsappURL;

    // Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Firebase
    try {
        await db.collection("orders").add({
            name,
            phone,
            address,
            cart,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        localStorage.removeItem("cart");

    } catch (err) {
        console.error(err);
        alert("âŒ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„ÙƒÙ† Ù„Ù… ÙŠØªÙ… Ø­ÙØ¸Ù‡ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
    }
}

        localStorage.removeItem("cart");

        // ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        const waNumber = "01158078805";
        const url = `https://wa.me/2${waNumber}?text=${encodeURIComponent(msg)}`;
        window.open(url, "_blank");

        alert("âœ” ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ³ÙŠØªÙ… ÙØªØ­ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¢Ù†");
        location.href = "products.html";

    } catch (err) {
        console.error(err);
        alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨");
    }
}

</script>

</body>
</html>
