<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>Maher Phone - Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    body{
        font-family:"Cairo", sans-serif;
        margin:0;
        background:#f3f4f6;
        direction:rtl;
    }

    header{
        background:white;
        padding:20px;
        color:black;
        text-align:center;
        font-size:28px;
        font-weight:700;
        position:sticky;
        top:0;
        box-shadow:0 2px 10px #00000015;
        z-index:10;
    }

    #categories{
        display:flex;
        overflow-x:auto;
        gap:12px;
        padding:15px;
        background:white;
        border-bottom:1px solid #ddd;
    }

    #categories button{
        padding:10px 18px;
        border:none;
        background:#111;
        color:white;
        border-radius:10px;
        cursor:pointer;
        white-space:nowrap;
        font-size:16px;
    }

    #products{
        display:grid;
        grid-template-columns:repeat(auto-fill, minmax(240px, 1fr));
        gap:20px;
        padding:20px;
    }

    .card{
        background:white;
        padding:15px;
        border-radius:14px;
        box-shadow:0 4px 10px #00000015;
        text-align:center;
    }

    .card img{
        width:100%;
        height:200px;
        object-fit:cover;
        border-radius:12px;
    }

    #cart-btn{
        position:fixed;
        bottom:20px;
        right:20px;
        width:60px;
        height:60px;
        background:#0d6efd;
        color:white;
        border:none;
        border-radius:50%;
        font-size:28px;
        cursor:pointer;
        box-shadow:0 0 18px #0d6efd66;
        z-index:9999;
    }

    /* Ø²Ø± Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø¹Ø§Ø¦Ù… */
    #admin-btn{
        position:fixed;
        bottom:20px;
        left:20px;
        width:55px;
        height:55px;
        background:#00aaff;
        color:white;
        border:none;
        border-radius:50%;
        font-size:28px;
        cursor:pointer;
        box-shadow:0 0 18px #00aaff66;
        display:flex;
        justify-content:center;
        align-items:center;
        transition:0.25s;
        z-index:9999;
    }

    #admin-btn:hover{
        background:#0088cc;
        box-shadow:0 0 22px #00aaffaa;
    }

    @media (max-width:600px){
        #admin-btn{
            width:50px;
            height:50px;
            bottom:15px;
            left:15px;
        }
    }
  </style>
</head>
<body>

<header>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</header>

<div id="categories"></div>

<div id="products"></div>

<!-- Ø²Ø± Ø§Ù„Ø³Ù„Ø© -->
<button id="cart-btn" onclick="location.href='cart.html'">ğŸ›’</button>

<!-- Ø²Ø± Ø§Ù„Ø£Ø¯Ù…Ù† -->
<button id="admin-btn" onclick="location.href='login.html'">âš™ï¸</button>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="firebase.js"></script>

<script>

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
db.collection("categories").get().then(snap=>{
    const bar = document.getElementById("categories");
    bar.innerHTML = `<button onclick="loadProducts()">Ø§Ù„ÙƒÙ„</button>`;

    snap.forEach(doc=>{
        let c = doc.data();
        bar.innerHTML += `
            <button onclick="loadProducts('${c.name}')">${c.name}</button>
        `;
    });
});


// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
function loadProducts(category){
    const container = document.getElementById("products");
    container.innerHTML = "<p style='text-align:center;width:100%'>â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>";

    let ref = db.collection("products").orderBy("createdAt", "desc");

    if(category){
        ref = ref.where("category", "==", category);
    }

    ref.get().then(snap=>{
        container.innerHTML = "";

        if(snap.empty){
            container.innerHTML = "<h3 style='text-align:center;width:100%'>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</h3>";
            return;
        }

        snap.forEach(doc=>{
            let p = doc.data();

            container.innerHTML += `
                <div class="card">
                    <img src="${p.imageURL}">
                    <h3>${p.name}</h3>
                    <p>${p.description}</p>
                    <p><strong>${p.price} Ø¬Ù†ÙŠÙ‡</strong></p>
                    <button onclick="addToCart('${doc.id}')">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
                </div>
            `;
        });
    });
}

loadProducts();


function addToCart(id){
    let cart = JSON.parse(localStorage.getItem("cart") || "[]");
    cart.push(id);
    localStorage.setItem("cart", JSON.stringify(cart));
    alert("âœ” ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ø³Ù„Ø©");
}

</script>

</body>
</html>
